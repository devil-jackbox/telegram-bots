{"ast":null,"code":"import _objectSpread from\"/workspace/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import{Editor}from'@monaco-editor/react';import{Save,Play,Square,RotateCcw,FileText,AlertTriangle,Settings,Activity,Clock}from'lucide-react';import{useBots}from'../contexts/BotContext';import{useSocket}from'../contexts/SocketContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BotEditor=()=>{const{botId}=useParams();const{bots,getBotFile,updateBotFile,startBot,stopBot,updateBot}=useBots();const{joinBotRoom,leaveBotRoom}=useSocket();const[code,setCode]=useState('');const[originalCode,setOriginalCode]=useState('');const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[bot,setBot]=useState(null);const[activeTab,setActiveTab]=useState('editor');const[logs,setLogs]=useState([]);const[errors,setErrors]=useState([]);useEffect(()=>{if(botId){joinBotRoom(botId);loadBotData();}return()=>{if(botId){leaveBotRoom(botId);}};},[botId]);const loadBotData=async()=>{try{setLoading(true);// Find bot in context\nconst currentBot=bots.find(b=>b.id===botId);if(!currentBot){throw new Error('Bot not found');}setBot(currentBot);// Load bot file\nconst fileData=await getBotFile(botId);setCode(fileData.content||'');setOriginalCode(fileData.content||'');}catch(error){console.error('Failed to load bot data:',error);}finally{setLoading(false);}};const handleSave=async()=>{if(code===originalCode){return;// No changes\n}setSaving(true);try{await updateBotFile(botId,code);setOriginalCode(code);}catch(error){console.error('Failed to save:',error);}finally{setSaving(false);}};const handleStart=async()=>{try{await startBot(botId);}catch(error){console.error('Failed to start bot:',error);}};const handleStop=async()=>{try{await stopBot(botId);}catch(error){console.error('Failed to stop bot:',error);}};const handleRestart=async()=>{try{await stopBot(botId);setTimeout(async()=>{await startBot(botId);},1000);}catch(error){console.error('Failed to restart bot:',error);}};const getLanguage=()=>{if(!bot)return'javascript';const languageMap={'javascript':'javascript','typescript':'typescript','python':'python','php':'php','ruby':'ruby','go':'go'};return languageMap[bot.language]||'javascript';};const getStatusBadge=()=>{if(!bot)return null;if(bot.status==='running'){return/*#__PURE__*/_jsx(\"span\",{className:\"badge-success\",children:\"Running\"});}if(bot.status==='error'){return/*#__PURE__*/_jsx(\"span\",{className:\"badge-error\",children:\"Error\"});}return/*#__PURE__*/_jsx(\"span\",{className:\"badge-warning\",children:\"Stopped\"});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"})});}if(!bot){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(AlertTriangle,{size:48,className:\"mx-auto text-red-500 mb-4\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:\"Bot Not Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"The bot you're looking for doesn't exist.\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"btn-primary\",children:\"Back to Dashboard\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"text-primary-600 hover:text-primary-700\",children:\"\\u2190 Back to Dashboard\"}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:bot.name}),getStatusBadge()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mt-1\",children:[bot.language,\" \\u2022 Created \",new Date(bot.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,disabled:saving||code===originalCode,className:\"btn-primary\",children:[/*#__PURE__*/_jsx(Save,{size:16}),saving?'Saving...':'Save']}),bot.status==='running'?/*#__PURE__*/_jsxs(\"button\",{onClick:handleStop,className:\"btn-secondary\",children:[/*#__PURE__*/_jsx(Square,{size:16}),\"Stop\"]}):/*#__PURE__*/_jsxs(\"button\",{onClick:handleStart,className:\"btn-success\",children:[/*#__PURE__*/_jsx(Play,{size:16}),\"Start\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleRestart,className:\"btn-secondary\",children:[/*#__PURE__*/_jsx(RotateCcw,{size:16}),\"Restart\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-8\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('editor'),className:\"py-2 px-1 border-b-2 font-medium text-sm \".concat(activeTab==='editor'?'border-primary-500 text-primary-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(FileText,{size:16,className:\"inline mr-2\"}),\"Code Editor\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('settings'),className:\"py-2 px-1 border-b-2 font-medium text-sm \".concat(activeTab==='settings'?'border-primary-500 text-primary-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(Settings,{size:16,className:\"inline mr-2\"}),\"Settings\"]})]})}),activeTab==='editor'&&/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-96\",children:/*#__PURE__*/_jsx(Editor,{height:\"100%\",language:getLanguage(),value:code,onChange:setCode,theme:\"vs-dark\",options:{minimap:{enabled:false},fontSize:14,lineNumbers:'on',roundedSelection:false,scrollBeyondLastLine:false,automaticLayout:true,wordWrap:'on',folding:true,lineDecorationsWidth:10,lineNumbersMinChars:3}})})}),activeTab==='settings'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Bot Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:bot.name,onChange:e=>setBot(_objectSpread(_objectSpread({},bot),{},{name:e.target.value})),className:\"input mt-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Language\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:bot.language,disabled:true,className:\"input mt-1 bg-gray-50\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Token\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:bot.token,onChange:e=>setBot(_objectSpread(_objectSpread({},bot),{},{token:e.target.value})),className:\"input mt-1\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"autoStart\",checked:bot.autoStart,onChange:e=>setBot(_objectSpread(_objectSpread({},bot),{},{autoStart:e.target.checked})),className:\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"autoStart\",className:\"ml-2 block text-sm text-gray-900\",children:\"Auto-start on platform launch\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{try{await updateBot(botId,{name:bot.name,token:bot.token,autoStart:bot.autoStart});}catch(error){console.error('Failed to update bot:',error);}},className:\"btn-primary\",children:\"Save Settings\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Bot Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Status\"}),getStatusBadge()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Created\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-900\",children:new Date(bot.createdAt).toLocaleString()})]}),bot.updatedAt&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Last Updated\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-900\",children:new Date(bot.updatedAt).toLocaleString()})]})]})]})]})]});};export default BotEditor;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}